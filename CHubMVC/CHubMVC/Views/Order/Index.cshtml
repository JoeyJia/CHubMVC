@{
    ViewBag.Title = "Quick Order Entry";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<style>
    label.form-control {
        margin-left:10px;
    }

</style>

<input type="hidden" value="@ViewBag.AppUser" id="hddAppUser" />

<div id="orderBody" ng-app="orderApp" ng-controller="orderCtrl">
    <form class="form-horizontal" action="/order/index" method="post">
        <div class="panel panel-default">
            <div class="panel-heading"><b>Quick Order Entry</b></div>
            
            <div class="row" style="margin-top:20px;">
                <div class="form-group">
                    <label for="orderID" class="col-sm-1 control-label">Order SEQ</label>
                    <div class="col-sm-1">
                        <input type="text" class="form-control" id="orderID" placeholder="Auto Generation" disabled>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="form-group">
                    <label for="cAlias" class="col-sm-1 control-label">Cus Alias</label>
                    <div class="col-sm-2">
                        <select class="form-control" id="cAlias" ng-model="selectedAlias" ng-options="ca.ALIAS_NAME for ca in custAlias" >

                        </select>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="form-group">
                    <label for="poNum" class="col-sm-1 control-label">PO No.</label>
                    <div class="col-sm-2">
                        <input type="text"  class="form-control" id="poNum" placeholder="Customer PO No.">
                    </div>

                    <label for="orderType" class="col-sm-1 control-label">Order Type</label>
                    <div class="col-sm-2">
                        <select class="form-control" id="orderType" ng-model="selectedOrderType" ng-options="ot.ORDER_TYPE for ot in orderType">

                        </select>
                    </div>

                    <label for="dueDate" class="col-sm-1 control-label">Due Date</label>
                    <div class="col-sm-1">
                        <input type="text" class="form-control" id="dueDate" placeholder="Due Date">
                    </div>

                    <label for="cShip" class="col-sm-1 control-label">Complete Ship</label>
                    <div class="col-sm-1">
                        <select class="form-control" id="cShip">
                            <option>N</option>
                            <option>Y</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="form-group">
                    <label for="notes" class="col-sm-1 control-label">Notes</label>
                    <div class="col-sm-9 col-lg-9">
                        <input type="text" class="form-control col-sm-8" id="notes" placeholder="Notes" value={{notice}} style="width:90%;">
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="form-group">
                    <label for="ssto" class="col-sm-1 control-label">SS to Order</label>
                    <div class="checkbox col-md-2 col-lg-2">
                        <label>
                            <input type="checkbox" id="ssto"  style="margin-left:1px;" checked>
                        </label>
                    </div>
                </div>
            </div>


                <div class="row" id="searchBox">
                    <div class="panel panel-default col-sm-7 col-sm-offset-1">
                        <div class="form-group" style="padding-top:10px">
                            <label for="shipName" class="col-sm-2 control-label">Ship Name</label>
                            <div class="col-sm-7 col-lg-7">
                                <input type="text" class="form-control" id="sbShipName" placeholder="Ship Name">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="sbAddr" class="col-sm-2 control-label">Address</label>
                            <div class="col-sm-7 col-lg-7">
                                <input type="text" class="form-control" id="sbAddr" placeholder="Address">
                            </div>

                            <div class="col-sm-2">
                                <button type="button" class="btn btn-default" onclick="searchAddrs();">Search</button>
                            </div>
                        </div>


                    </div>
                </div>




            </div>
    </form>
</div>

<!-- Large modal -->
<button type="button" class="btn btn-primary" data-toggle="modal" data-target=".bs-example-modal-lg">Large modal</button>

<div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            ...
        </div>
    </div>
</div>

<!-- Small modal -->
<button type="button" class="btn btn-primary" data-toggle="modal" data-target=".bs-example-modal-sm">Small modal</button>

<div class="modal fade bs-example-modal-sm" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            ...
        </div>
    </div>
</div>

<!-- Search result modal-->
<div class="modal fade" id="aliasSearch" role="dialog" aria-labelledby="result" aria-hidden="true" ng-app="resultApp" ng-controller="searchResultCtrl">
    <div class="modal-dialog" style="width:90%">
        <div class="modal-content">
            <div class="modal-header">
                <h4>Address Result</h4>
            </div>

            <div class="modal-body">
                    <table id="searchResult" class="table table-striped table-hover">
                        <thead>
                            <tr>
                                <th style="width:10px"></th>
                                <th>Duration(days)</th>
                                <th>Distance</th>
                                <th>WareHouse</th>
                                <th>Attention</th>
                                <th>Ship to Name</th>
                                <th>Addr1</th>
                                <th>Addr2</th>
                                <th>Addr3</th>
                                <th>City</th>
                                <th>Province</th>
                            </tr>
                        </thead>
                        <tbody style="display:none">
                            <tr ng-repeat="rd in resultData ">
                                <td style="">123
                                    @*<div class="radio">
                                        <label>
                                            <input type="radio" name="blankRadio" id="blankRadio1" value="option1">
                                        </label>
                                    </div>*@
                              </td>
                                <td>rd.Days</td>
                                <td>rd.Distance</td>
                                <td>rd.WareHouse</td>
                                <td>rd.DestAttention</td>
                                <td>rd.LocalDestName</td>
                                <td>rd.LocalDestAddr1</td>
                                <td>rd.LocalDestAddr2</td>
                                <td>rd.LocalDestAddr3</td>
                                <td>rd.LocalDestCity</td>
                                <td>rd.LocalDestState</td>
                            </tr>
                        </tbody>
                    </table>

                <input type="text" value={{selectedItem}} placeholder="teing" />
                <input type="text" id="testInput" placeholder="teing" />

            </div>
        </div>
    </div>
</div>

<script>
    $(document).ready(function () {

        //alert("loaded");
    });


    //Angular orderApp start
    angular.module('orderApp', []).controller('orderCtrl', function ($scope, $http) {

        $http.post("/order/init",null,null).then(function (resp) {
        $scope.custAlias = resp.data.custAlias;
        $scope.orderType = resp.data.orderType;

        $scope.selectedAlias = resp.data.selectedAlias;
        $scope.selectedOrderType = "";
            //debugger;

        $scope.searchBtn = function () {
            $("#aliasSearch").modal("show");
        };


        }, 
     function (resp) {
         alert("Fail!");
        // $scope.resp = resp;
     });
    });


    angular.module('resultApp', []).controller('searchResultCtrl', function ($scope, $http) {

        $scope.resultData = "";
        $scope.selectedItem = "";

    });

    angular.bootstrap(document.getElementById("aliasSearch"), ['resultApp']);

    //Functions start
    function searchAddrs()
    {
        debugger;
        var shipName = $("#sbShipName").val();
        var addr = $("#sbAddr").val();
        var isSpecialShip = $("#ssto")[0].checked;

        $.ajax({
            url: "/order/SearchAddrs",
            data: {
                shipName: shipName,
                addr: addr,
                isSpecialShip: isSpecialShip
            },
            type:"post",
            async:false,
            success: function (obj) {
                debugger;
                var appElement = document.querySelector('[ng-controller=searchResultCtrl]');
                var scope = angular.element(appElement).scope();
                scope.resultData = obj;
                scope.selectedItem = "scoping";

                $("#testInput").val("知道");
                
                scope.$apply();
                $("#aliasSearch").modal("show");

            },
            error: function (obj)
            {
                alert("fail");
                debugger;
            }

        });


    }

</script>
