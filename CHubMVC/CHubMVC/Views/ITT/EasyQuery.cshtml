
@{
    ViewBag.Title = "Easy Query";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<div class="container-fluid" id="easyQueryBody" ng-app="easyQueryApp" ng-controller="easyQueryCtrl">
    <div class="panel panel-default">
        <div class="panel-heading"><b>Easy Query</b></div>

        <form class="form-horizontal" id="searchForm">
            <div class="row" style="margin-top:20px;margin-bottom:20px">
                <div class="form-group">
                    <label for="orderID" class="col-sm-2 control-label small">Part No.</label>
                    <div class="col-sm-2 col-lg-2">
                        <input type="text" class="form-control input-sm" ng-model="partNo" placeholder="Part No.">
                    </div>
                    <div class="col-sm-2">
                        <button class="btn btn-primary btn-sm" ng-click="fuzzySearch()">Search</button>
                    </div>
                </div>

            </div>
        </form>
        <hr>
        
        <!--Page body-->
        <div class="row">
            <div class="col-md-5">
                <div class="panel panel-default">
                    <div class="panel-heading"><b>Part Basic Info</b></div>
                    <table class="table table-bordered table-striped .table-condensed" style="border-color:black;">

                        <tr>
                            <td style=""><b>PartNo</b></td>
                            <td colspan="3">{{selectedPart.PART_NO}}</td>
                        </tr>
                        <tr>
                            <td style=""><b>Description</b></td>
                            <td >{{selectedPart.DESCRIPTION}}</td>
                            <td style=""><b>Chinese Desc</b></td>
                            <td >{{selectedPart.DESC_CN}}</td>
                        </tr>
                        <tr>
                            <td style=""><b>Buyer</b></td>
                            <td>{{selectedPart.PLANNER_BUYER}}</td>
                            <td style=""><b>Print Part No.</b></td>
                            <td>{{selectedPart.PRINT_PART_NO}}</td>
                        </tr>
                        <tr>
                            <td style=""><b>SSC</b></td>
                            <td>{{selectedPart.CURRENT_SALES_STATUS_CODE}}</td>
                            <td style=""><b>Part Status</b></td>
                            <td>{{selectedPart.PART_STATUS}}</td>
                        </tr>
                        <tr>
                            <td style=""><b>L*W*H</b></td>
                            <td>{{selectedPart.LWH}}</td>
                            <td style=""><b>Weight</b></td>
                            <td>{{selectedPart.PART_WEIGHT}}</td>
                        </tr>
                        <tr>
                            <td style=""><b>Make to Order</b></td>
                            <td>{{selectedPart.MAKE_TO_FLAG}}</td>
                            <td style=""><b>Tran Code</b></td>
                            <td>{{selectedPart.PART_NO}}</td>
                        </tr>
                        <tr>
                            <td style=""><b>Release Date</b></td>
                            <td>{{selectedPart.PART_NO}}</td>
                            <td style=""><b>Note</b></td>
                            <td>{{selectedPart.PART_NO}}</td>
                        </tr>
                        <tr>
                            <td style=""><b>Remark 1</b></td>
                            <td>{{selectedPart.PART_NO}}</td>
                            <td style=""><b>Remark 2</b></td>
                            <td>{{selectedPart.PART_NO}}</td>
                        </tr>
                        <tr>
                            <td style=""><b>Remark 3</b></td>
                            <td>{{selectedPart.PART_NO}}</td>
                            <td style=""><b>Remark 4</b></td>
                            <td>{{selectedPart.PART_NO}}</td>
                        </tr>
                        <tr>
                            <td style=""><b>Remark 5</b></td>
                            <td>{{selectedPart.PART_NO}}</td>
                        </tr>
                        <!--CIQ Features part-->
                        <tr>
                            <td style="" colspan="4"><b>CIQ Features</b></td>
                        </tr>
                        <tr>
                            <td style="">Declaration Name</td>
                            <td></td>
                            <td style="">HS Code</td>
                            <td></td>
                        </tr>
                        <tr>
                            <td style="">TC Category Identified</td>
                            <td></td>
                        </tr>
                        <tr>
                            <td style="">Note</td>
                            <td></td>
                        </tr>


                    </table>
                </div>
            </div>
            <div class="col-md-5">
                <div class="panel panel-default">
                    <div class="panel-heading"><b>Watching Out</b></div>
                    <table class="table table-bordered table-striped .table-condensed" style="border-color:black;">
                        <thead>
                            <tr>
                                <th>Message</th>
                                <th>Details</th>
                            </tr>
                        </thead>
                        <tr>
                            <td style=""><b>PartNo</b></td>
                            <td colspan="3">123</td>
                        </tr>


                    </table>
                </div>
            </div>
        </div>

        <!--Inventory Shapshot Part-->
        <div class="row">
            <div class="col-md-10">
                <div class="panel panel-default">
                    <div class="panel-heading"><b>Inventory Shapshot</b></div>
                    <table class="table table-bordered table-striped .table-condensed" style="border-color:black;">
                        <thead>
                            <tr>
                                <th></th>
                                <th>Ware House</th>
                                <th>Bay No</th>
                                <th>Qty Available</th>
                                <th>Qty Onhand</th>
                                <th>Qty Reserved</th>
                                <th>Qty In Receiving</th>
                            </tr>
                        </thead>
                        <tr>
                            <td rowspan="2">China PDC</td>
                            <td>305</td>
                            <td>AVL</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                          
                            <td>300</td>
                            <td>AVL</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td rowspan="4">China RDC</td>
                            <td>BJRDC</td>
                            <td>AVL</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                          
                            <td>SYRDC</td>
                            <td>AVL</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                           
                            <td>XARDC</td>
                            <td>AVL</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            
                            <td>CSWRDC</td>
                            <td>AVL</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>

                        <tr>
                            <td rowspan="3">Inter PDC</td>
                            <td>MDC</td>
                            <td>AVL</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            
                            <td>MPDC</td>
                            <td>AVL</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            
                            <td>SPDC</td>
                            <td>AVL</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                       
                    </table>
                </div>
            </div>
        </div>

        <!--SO/PO Opening Qty Snap Shot Part-->
        <div class="row">
            <div class="col-md-11">
                <div class="panel panel-default">
                    <div class="panel-heading"><b>SO/PO Opening Qty Snap Shot</b></div>
                    <table class="table table-bordered table-striped .table-condensed" style="border-color:black;">
                        <tr>
                            <td rowspan="2">Item</td>
                            <td rowspan="2">Warehouse</td>
                            <td colspan="4">Sales Orders</td>
                            <td colspan="3">Purchasing Orders</td>
                        </tr>
                        <tr>
                            <td>Qty BackOrdered</td>
                            <td>Qty Opening</td>
                            <td>Qty Reserved</td>
                            <td>Qty in Picking</td>
                            <td>Remaining Qtys</td>
                            <td>Latest ETA</td>
                            <td>IN Transit</td>
                        </tr>
                        <tr>
                            <td rowspan="2">China PDC</td>
                            <td>305</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>

                            <td>300</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>

                        <tr>
                            <td rowspan="4">China RDC</td>
                            <td>BJRDC</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>

                            <td>SYRDC</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>

                            <td>XARDC</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>

                            <td>CSWRDC</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>

                    </table>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-11">
                <div class="panel panel-default">
                    <div class="panel-heading"><b>SO/PO Opening Qty Snap Shot</b></div>

                    <ul class="nav nav-pills" role="tablist">
                        <li role="presentation" class="active"><a href="#home" role="tab" data-toggle="tab">Home</a></li>
                        <li role="presentation"><a href="#profile" role="tab" data-toggle="tab">Profile</a></li>
                        <li role="presentation"><a href="#messages" role="tab" data-toggle="tab">Messages</a></li>
                        <li role="presentation"><a href="#settings" role="tab" data-toggle="tab">Settings</a></li>
                    </ul>

                    <!---->
                    <div class="tab-content">
                        <div role="tabpanel" class="tab-pane active" id="home">...1</div>
                        <div role="tabpanel" class="tab-pane" id="profile">...2</div>
                        <div role="tabpanel" class="tab-pane" id="messages">...3</div>
                        <div role="tabpanel" class="tab-pane" id="settings">...4</div>
                    </div> 
                    </div>
                </div>
        </div>

    </div>
</div>


<!--Part List Modal-->
<div class="modal fade" id="partListModal" role="dialog" aria-labelledby="result" aria-hidden="true" ng-app="partListApp" ng-controller="partListCtrl">
    <div class="modal-dialog" style="width:90%">
        <div class="modal-content">
            <div class="modal-header">
                <h4>Part No List</h4>
            </div>

            <div class="modal-body">

                <table id="tbPartNoList" class="table table-striped table-hover table-bordered .table-condensed">
                    <thead>
                        <tr>
                            <th style="width:10px"></th>
                            <th style="">Part No.</th>
                            <th style="">Description</th>
                            <th style="">Chinese Desc</th>
                            <th>Buyer</th>
                            <th>Part Status</th>
                            <th>SSC</th>
                            <th>Print Part No.</th>
                            <th>L*W*H</th>
                            <th>Weight</th>
                        </tr>
                    </thead>
                    <tbody style="">
                        <tr ng-repeat="pl in partList ">
                            <td style="">
                                <div class="radio">
                                    <label>
                                        <input type="radio" name="optionsRdios" id="optionsRdios$index" class="partRadio" seq="{{$index}}" value="">
                                    </label>
                                </div>
                            </td>
                            <td>{{pl.PART_NO}}</td>
                            <td>{{pl.DESCRIPTION}}</td>
                            <td>{{pl.DESC_CN}}</td>
                            <td>{{pl.PLANNER_BUYER}}</td>
                            <td>{{pl.PART_STATUS}}</td>
                            <td>{{pl.CURRENT_SALES_STATUS_CODE}}</td>
                            <td>{{pl.PRINT_PART_NO}}</td>
                            <td>{{pl.LWH}}</td>
                            <td>{{pl.PART_WEIGHT}}</td>
                        </tr>
                    </tbody>
                </table>
                <div class="row">
                    <div class="col-md-2 col-md-offset-10">
                        <button type="button" class="btn btn-primary" onclick="confirmAddr()">Confirm</button>
                        <button type="button" class="btn btn-primary" onclick="cancelAddr()">Cancel</button>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>

<script>
    

    angular.module('easyQueryApp', []).controller('easyQueryCtrl', function ($scope, $http) {
        $scope.result = [];
        $scope.partNo = "";
        $scope.selectedPart = "";
        

        $scope.fuzzySearch = function () {
            if ($scope.partNo == "")
                return;

            $.ajax({
                url: "/itt/FuzzyQueryParNo",
                data: {
                    fuzzypartNo: $scope.partNo,
                },
                type: "post",
                async: false,
                success: function (obj) {
                    debugger;
                    $scope.result = obj;
                    
                    var appElement = document.querySelector('[ng-controller=partListCtrl]');
                        var scope = angular.element(appElement).scope();
                        scope.partList = $scope.result;
                        scope.$apply();
                        $("#partListModal").modal("show");

                },
                error: function (obj) {
                    alert(obj.responseText);
                }
            });

        }



    });

    //manual load app
    angular.bootstrap(document.getElementById("easyQueryBody"), ['easyQueryApp']);

    //For part modal part
    angular.module('partListApp', []).controller('partListCtrl', function ($scope, $http) {
        $scope.partList = [];


        //$scope.cancel = function () {
        //    $("#partReadModal").modal("hide");
        //}

        //$scope.showAuditLog = function () {
        //    //debugger;
        //    var appElement = document.querySelector('[ng-controller=auditLogCtrl]');
        //    var scope = angular.element(appElement).scope();
        //    scope.partNo = $scope.currentData.PART_NO;
        //    scope.loadAuditLog();
        //    scope.$apply();
        //    $("#auditLogModal").modal("show");
        //}


    });

    //Add second app to document
    angular.bootstrap(document.getElementById("partListModal"), ['partListApp']);
</script>
<script>

    function confirmAddr() {
        for (var i = 0; i < $(".partRadio").length ; i++) {
            if ($(".partRadio")[i].checked) {
                var seq = $(".partRadio")[i].attributes['seq'].value;
                var appElement = document.querySelector('[ng-controller=partListCtrl]');
                var scope = angular.element(appElement).scope();
                var selected = scope.partList[seq];

                var appElement1 = document.querySelector('[ng-controller=easyQueryCtrl]');
                var scope1 = angular.element(appElement1).scope();
                scope1.selectedPart = selected;
                scope1.$apply();
                break;
            }

        }
        $("#partListModal").modal("hide");
    }

    function cancelAddr() {
        $("#partListModal").modal("hide");
    }

</script>
